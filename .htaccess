RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

<Files secure.php>
AuthType SSLCert
Require valid-user
ErrorDocument 401 /index.php?hash=error
</Files>

<Files secure2.php>
AuthType SSLCert
Require valid-user
ErrorDocument 401 /index2.php?hash=error
</Files>

RewriteCond %{REQUEST_URI} !^blog
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^!([^\.]+)$ index2.php?hash=$1
RewriteCond %{REQUEST_URI} !^blog
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^\.]+)$ index.php?hash=$1
ErrorDocument 403 /index.php
ErrorDocument 404 /index.php
ErrorDocument 500 /index.php
